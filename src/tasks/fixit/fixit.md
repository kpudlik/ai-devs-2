Fix implementation and return 0 for non numeric inputs. Optimize the complexity.
